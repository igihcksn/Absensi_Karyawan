select tb_absensi.tgl_absensi, tb_karyawan.nm_karyawan,(select count(*) from tb_absensi where tb_absensi.ktrmasuk='Tidak Masuk' and nik = tb_karyawan.nik and tb_absensi.tgl_absensi='"+"waktu1.Value.ToString('yyyy-MM-dd') + "' and tgl_absensi <='" + waktu2.Value.ToString('yyyy-MM-dd') + "'") as Tidak_Masuk,(select count(*) from tb_absensi where tb_absensi.ktrmasuk='Terlambat' and tb_absensi.tgl_absensi='"+"waktu1.Value.ToString('yyyy-MM-dd') + "' and tgl_absensi <='" + waktu2.Value.ToString('yyyy-MM-dd') + "'" and nik = tb_karyawan.nik) as terlambat,(select count(*) from tb_absensi where tb_absensi.ktrpulang='Pulang Awal' and nik = tb_karyawan.nik and tb_absensi.tgl_absensi='" + waktu1.Value.ToString('yyyy-MM-dd') + "' and tgl_absensi <='" + waktu2.Value.ToString('yyyy-MM-dd') + "'") as Pulang_Awal from tb_karyawan,tb_absensi where tb_karyawan.nik=tb_absensi.nik and tb_absensi.tgl_absensi='" + waktu1.Value.ToString('yyyy-MM-dd') + "' and tgl_absensi <='" + waktu2.Value.ToString('yyyy-MM-dd') + "'"